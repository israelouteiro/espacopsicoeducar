{"ast":null,"code":"import _objectSpread from\"/Users/israelouteiro/Desktop/EspacoPsicoEducar/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/israelouteiro/Desktop/EspacoPsicoEducar/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/israelouteiro/Desktop/EspacoPsicoEducar/node_modules/@babel/runtime/regenerator/index.js\";import{ReadObject,SaveObject}from'./storage';export var DEVELOPMENT_MODE=true;export var API_ENDPOINT='https://boilerplate.xapps-staging.com/';export var GetHeaders=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(authenticated){var headers,authentication;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:headers={'Content-Type':'application/json'};_context.next=3;return ReadObject('authentication');case 3:authentication=_context.sent;if(authenticated&&authentication.jwt){headers.Authorization=\"Bearer \".concat(authentication.jwt);}return _context.abrupt(\"return\",{headers:headers});case 6:case\"end\":return _context.stop();}}},_callee);}));return function GetHeaders(_x){return _ref.apply(this,arguments);};}();export var ServerFetch=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(url,options,authenticated){var _yield$GetHeaders,headers,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return GetHeaders(authenticated);case 2:_yield$GetHeaders=_context2.sent;headers=_yield$GetHeaders.headers;_context2.prev=4;_context2.next=7;return fetch(url,_objectSpread(_objectSpread({},options),{},{headers:headers}));case 7:response=_context2.sent;if(!(response.statusCode===403&&authenticated)){_context2.next=11;break;}_context2.next=11;return SaveObject('authentication',{});case 11:_context2.prev=11;_context2.next=14;return response.json();case 14:return _context2.abrupt(\"return\",_context2.sent);case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](11);console.log('ServerParseError',_context2.t0);return _context2.abrupt(\"return\",response);case 21:_context2.next=27;break;case 23:_context2.prev=23;_context2.t1=_context2[\"catch\"](4);console.log('ServerFetchError',_context2.t1);return _context2.abrupt(\"return\",false);case 27:case\"end\":return _context2.stop();}}},_callee2,null,[[4,23],[11,17]]);}));return function ServerFetch(_x2,_x3,_x4){return _ref2.apply(this,arguments);};}();export var GET=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(path){var authenticated,_args3=arguments;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:authenticated=_args3.length>1&&_args3[1]!==undefined?_args3[1]:false;_context3.next=3;return ServerFetch(\"\".concat(API_ENDPOINT).concat(path),{method:'GET'},authenticated);case 3:return _context3.abrupt(\"return\",_context3.sent);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function GET(_x5){return _ref3.apply(this,arguments);};}();export var POST=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(path,body){var authenticated,_args4=arguments;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:authenticated=_args4.length>2&&_args4[2]!==undefined?_args4[2]:false;_context4.next=3;return ServerFetch(\"\".concat(API_ENDPOINT).concat(path),{method:'POST',body:JSON.stringify(body)},authenticated);case 3:return _context4.abrupt(\"return\",_context4.sent);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function POST(_x6,_x7){return _ref4.apply(this,arguments);};}();export var PUT=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(path,body){var authenticated,_args5=arguments;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:authenticated=_args5.length>2&&_args5[2]!==undefined?_args5[2]:false;_context5.next=3;return ServerFetch(\"\".concat(API_ENDPOINT).concat(path),{method:'PUT',body:JSON.stringify(body)},authenticated);case 3:return _context5.abrupt(\"return\",_context5.sent);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function PUT(_x8,_x9){return _ref5.apply(this,arguments);};}();export var DELETE=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(path){var authenticated,_args6=arguments;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:authenticated=_args6.length>1&&_args6[1]!==undefined?_args6[1]:false;_context6.next=3;return ServerFetch(\"\".concat(API_ENDPOINT).concat(path),{method:'DELETE'},authenticated);case 3:return _context6.abrupt(\"return\",_context6.sent);case 4:case\"end\":return _context6.stop();}}},_callee6);}));return function DELETE(_x10){return _ref6.apply(this,arguments);};}();export var ReadAddressesByZipCode=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(zipCode){var result;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return fetch(\"https://viacep.com.br/ws/\".concat(zipCode,\"/json/\"));case 3:result=_context7.sent;return _context7.abrupt(\"return\",result.json());case 7:_context7.prev=7;_context7.t0=_context7[\"catch\"](0);return _context7.abrupt(\"return\",false);case 10:case\"end\":return _context7.stop();}}},_callee7,null,[[0,7]]);}));return function ReadAddressesByZipCode(_x11){return _ref7.apply(this,arguments);};}();export var PostImage=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(fileToUpload){var formData,_yield$GetHeaders2,headers,response,responseJson;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:formData=new FormData();formData.append('file',fileToUpload,fileToUpload.name);_context8.next=4;return GetHeaders(true);case 4:_yield$GetHeaders2=_context8.sent;headers=_yield$GetHeaders2.headers;delete headers['Content-Type'];_context8.next=9;return fetch(\"\".concat(API_ENDPOINT,\"/upload\"),{method:'POST',body:formData,headers:headers});case 9:response=_context8.sent;_context8.next=12;return response.json();case 12:responseJson=_context8.sent;return _context8.abrupt(\"return\",responseJson);case 14:case\"end\":return _context8.stop();}}},_callee8);}));return function PostImage(_x12){return _ref8.apply(this,arguments);};}();export var PrepareImageFile=function PrepareImageFile(image){var btc=window.atob(image.source);var btn=new Array(btc.length);for(var i=0;i<btc.length;i++){btn[i]=btc.charCodeAt(i);}var bta=new Uint8Array(btn);var boobs=new Blob([bta],{type:'image/png'});return new File([boobs],\"\".concat(image.filename));};export var UploadImage=function UploadImage(file){return new Promise(function(resolve,reject){var reader=new FileReader();reader.onload=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){var source,image,thefile,result;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:source=\"\".concat(reader.result).split(',')[1];image={filename:file.name,filetype:file.type,source:source};thefile=PrepareImageFile(image);_context9.next=5;return PostImage(thefile);case 5:result=_context9.sent;resolve(result);case 7:case\"end\":return _context9.stop();}}},_callee9);}));reader.readAsDataURL(file);});};export var parseStrapiImage=function parseStrapiImage(url){return!url?'':url.indexOf('://')!==-1?url:\"\".concat(API_ENDPOINT.replace('/api','')).concat(url);};","map":{"version":3,"sources":["/Users/israelouteiro/Desktop/EspacoPsicoEducar/src/services/api.js"],"names":["ReadObject","SaveObject","DEVELOPMENT_MODE","API_ENDPOINT","GetHeaders","authenticated","headers","authentication","jwt","Authorization","ServerFetch","url","options","fetch","response","statusCode","json","console","log","GET","path","method","POST","body","JSON","stringify","PUT","DELETE","ReadAddressesByZipCode","zipCode","result","PostImage","fileToUpload","formData","FormData","append","name","responseJson","PrepareImageFile","image","btc","window","atob","source","btn","Array","length","i","charCodeAt","bta","Uint8Array","boobs","Blob","type","File","filename","UploadImage","file","Promise","resolve","reject","reader","FileReader","onload","split","filetype","thefile","readAsDataURL","parseStrapiImage","indexOf","replace"],"mappings":"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","sourcesContent":["import { ReadObject, SaveObject } from './storage'\n\nexport const DEVELOPMENT_MODE = true \nexport const API_ENDPOINT ='https://boilerplate.xapps-staging.com/'\n\nexport const GetHeaders = async authenticated => {\n\tconst headers = { 'Content-Type': 'application/json' }\n\tconst authentication = await ReadObject('authentication')\n\tif (authenticated && authentication.jwt) {\n\t\theaders.Authorization = `Bearer ${authentication.jwt}`\n\t}\n\treturn { headers }\n}\n\nexport const ServerFetch = async (url, options, authenticated) => {\n\tconst { headers } = await GetHeaders(authenticated)\n\t// console.info(url, options, headers)\n\ttry{\n\t\tconst response = await fetch(url, { ...options, headers }) \n\t\tif (response.statusCode === 403 && authenticated) {\n\t\t\tawait SaveObject('authentication', {})\n\t\t}\n\t\ttry{\n\t\t\treturn await response.json()\n\t\t}catch(err){\n\t\t\tconsole.log('ServerParseError', err)\n\t\t\treturn response\n\t\t}  \n\t}catch(error){\n\t\tconsole.log('ServerFetchError', error)\n\t\treturn false;\n\t}\n}\n\nexport const GET = async (path, authenticated = false) => {\n\treturn await ServerFetch(\n\t\t`${API_ENDPOINT}${path}`,\n\t\t{\n\t\t\tmethod: 'GET'\n\t\t},\n\t\tauthenticated\n\t)\n}\n\nexport const POST = async (path, body, authenticated = false) => {\n\treturn await ServerFetch(\n\t\t`${API_ENDPOINT}${path}`,\n\t\t{\n\t\t\tmethod: 'POST',\n\t\t\tbody: JSON.stringify(body)\n\t\t},\n\t\tauthenticated\n\t)\n}\n\nexport const PUT = async (path, body, authenticated = false) => {\n\treturn await ServerFetch(\n\t\t`${API_ENDPOINT}${path}`,\n\t\t{\n\t\t\tmethod: 'PUT',\n\t\t\tbody: JSON.stringify(body)\n\t\t},\n\t\tauthenticated\n\t)\n}\n\nexport const DELETE = async (path, authenticated = false) => {\n\treturn await ServerFetch(\n\t\t`${API_ENDPOINT}${path}`,\n\t\t{\n\t\t\tmethod: 'DELETE'\n\t\t},\n\t\tauthenticated\n\t)\n} \n\nexport const ReadAddressesByZipCode = async (zipCode) => {\n    try{\n        let result = await fetch(`https://viacep.com.br/ws/${ zipCode }/json/`);\n        return result.json();\n    }catch(err){ return false; }\n}\n\n\n\nexport const PostImage = async (fileToUpload) => {\n    const formData = new FormData()\n    formData.append('file', fileToUpload, fileToUpload.name)  \n    let { headers } = await GetHeaders(true) \n    delete headers['Content-Type']\n    let response = await fetch(`${API_ENDPOINT}/upload`, { method: 'POST', body: formData, headers });   \n    let responseJson = await response.json()  \n    return responseJson; \n}\n  \nexport const PrepareImageFile = (image) => {\n\tlet btc = window.atob(image.source)\n\tlet btn = new Array(btc.length);\n\tfor (var i = 0; i < btc.length; i++) {\n\t\tbtn[i] = btc.charCodeAt(i);\n\t}\n\tvar bta = new Uint8Array(btn);\n\tlet boobs = new Blob([bta], {type: 'image/png' } );\n\treturn new File([boobs], `${ image.filename }`)\n} \n\nexport const UploadImage = (file) => {\n\treturn new Promise((resolve, reject) => { \n\t\tlet reader = new FileReader();\n\t\treader.onload = async () => {\n\t\t\tlet source = `${ reader.result }`.split(',')[1]\n\t\t\tlet image = {\n\t\t\t\tfilename: file.name,\n\t\t\t\tfiletype: file.type,\n\t\t\t\tsource\n\t\t\t}\n\t\t\tlet thefile = PrepareImageFile(image);\n\t\t\tlet result = await PostImage(thefile);\n\n\t\t\tresolve(result);\n\t\t};\n\t\treader.readAsDataURL(file);\n\t})\n} \n \nexport const parseStrapiImage = url => {\n    return !url ? '' : url.indexOf('://') !== -1 ? url : `${API_ENDPOINT.replace('/api', '')}${url}`\n}"]},"metadata":{},"sourceType":"module"}