{"ast":null,"code":"import _asyncToGenerator from\"/Users/israelouteiro/Desktop/EspacoPsicoEducar/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/israelouteiro/Desktop/EspacoPsicoEducar/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/israelouteiro/Desktop/EspacoPsicoEducar/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/israelouteiro/Desktop/EspacoPsicoEducar/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/israelouteiro/Desktop/EspacoPsicoEducar/node_modules/@babel/runtime/regenerator/index.js\";import React,{useContext,useState}from\"react\";import{useHistory}from'react-router-dom';import{toast}from'react-toastify';import Input from'components/Input';import{FormTitle,FormText,FormSpacer,RegisterForgot,ForgotLink,RegisterCall}from'./styled';import ContainerUnauthenticated from\"containers/Unauthenticated\";import{CoreContext}from\"context/CoreContext\";import{DoLogin}from\"services/authentication\";import{exposeStrapiError}from\"utils\";import Button from\"components/Button\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Login(){var history=useHistory();var navigate=function navigate(to){return history.push(\"/\".concat(to));};var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useContext=useContext(CoreContext),setUser=_useContext.setUser;var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),form=_useState4[0],setForm=_useState4[1];var formValue=function formValue(ref){return form!==null&&form!==void 0&&form[ref]?form===null||form===void 0?void 0:form[ref]:'';};var changeForm=function changeForm(value,ref){setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},ref,value)));};var valid=function valid(){var verbose=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!formValue('identifier')||!formValue('identifier').length){if(verbose){toast.error('Preencha o campo: Email');}return false;}if(!formValue('password')||!formValue('password').length){if(verbose){toast.error('Preencha o campo: Senha');}return false;}return true;};var login=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _form$identifier;var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(valid(true)){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setLoading(true);_context.next=5;return DoLogin(_objectSpread(_objectSpread({},form),{},{identifier:(_form$identifier=form.identifier)===null||_form$identifier===void 0?void 0:_form$identifier.replace(/ /g,'')}));case 5:result=_context.sent;setLoading(false);if(result&&!exposeStrapiError(result)){completeLogin(result);}case 8:case\"end\":return _context.stop();}}},_callee);}));return function login(){return _ref.apply(this,arguments);};}();var completeLogin=function completeLogin(result){if(result!==null&&result!==void 0&&result.user){setUser(result.user);}navigate('dashboard');};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(ContainerUnauthenticated,{children:[/*#__PURE__*/_jsx(FormTitle,{children:\"Bem-vindo de volta!\"}),/*#__PURE__*/_jsx(FormText,{children:\"Entre com seus dados do cadastro para acessar sua conta\"}),/*#__PURE__*/_jsx(Input,{placeholder:\"E-mail\",value:formValue('identifier'),onChange:function onChange(e){return changeForm(e.target.value,'identifier');}}),/*#__PURE__*/_jsx(FormSpacer,{}),/*#__PURE__*/_jsx(Input,{placeholder:\"Senha\",type:\"password\",value:formValue('password'),onChange:function onChange(e){return changeForm(e.target.value,'password');}}),/*#__PURE__*/_jsxs(RegisterForgot,{children:[\"Esqueceu a senha?\",/*#__PURE__*/_jsx(ForgotLink,{onClick:function onClick(){return navigate('forgot');},children:\"Recupere sua senha\"})]}),/*#__PURE__*/_jsx(FormSpacer,{}),/*#__PURE__*/_jsx(Button,{primary:true,loading:loading,onClick:login,children:\"Entrar\"}),/*#__PURE__*/_jsx(RegisterCall,{children:\" Ainda n\\xE3o tem conta? \"}),/*#__PURE__*/_jsx(Button,{primary:true,outline:true,onClick:function onClick(){return navigate('register');},children:\"Criar uma conta\"})]})});}","map":{"version":3,"sources":["/Users/israelouteiro/Desktop/EspacoPsicoEducar/src/screens/Authentication/Login/index.js"],"names":["React","useContext","useState","useHistory","toast","Input","FormTitle","FormText","FormSpacer","RegisterForgot","ForgotLink","RegisterCall","ContainerUnauthenticated","CoreContext","DoLogin","exposeStrapiError","Button","Login","history","navigate","to","push","loading","setLoading","setUser","form","setForm","formValue","ref","changeForm","value","valid","verbose","length","error","login","identifier","replace","result","completeLogin","user","e","target"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from \"react\"; \nimport { useHistory } from 'react-router-dom';\nimport { toast } from 'react-toastify';\n\nimport Input from 'components/Input'\n\nimport { \n    FormTitle,\n    FormText,\n    FormSpacer,\n    RegisterForgot,\n    ForgotLink,\n    RegisterCall\n} from './styled' \n\nimport ContainerUnauthenticated from \"containers/Unauthenticated\";\nimport { CoreContext } from \"context/CoreContext\";\nimport { DoLogin } from \"services/authentication\";\nimport { exposeStrapiError } from \"utils\";\nimport Button from \"components/Button\";\n\nexport default function Login(){ \n    const history = useHistory();\n    const navigate = to => history.push(`/${ to }`);\n\n    const [ loading, setLoading ] = useState(false)\n    const { setUser } = useContext(CoreContext)\n    \n    const [ form, setForm ] = useState({})\n    const formValue = ref => { return form?.[ref] ? form?.[ref] : '' ;}\n    const changeForm = ( value, ref ) => { setForm({ ...form, [ref]: value }) ;} \n\n    const valid = (verbose = false) => {  \n\n        if(!formValue('identifier') || !formValue('identifier').length){ \n            if(verbose){ toast.error('Preencha o campo: Email') ;}\n            return false; \n        }  \n\n        if(!formValue('password') || !formValue('password').length){ \n            if(verbose){ toast.error('Preencha o campo: Senha') ;}\n            return false; \n        }  \n\n        return true\n    } \n\n    const login = async () => {\n        if(!valid(true)){ return ;}\n        setLoading(true)\n        const result = await DoLogin({ ...form, identifier: form.identifier?.replace(/ /g,'') })  \n        setLoading(false)\n        if(result && !exposeStrapiError(result)){\n            completeLogin(result)\n        } \n    }\n\n    const completeLogin = (result) => {\n        if(result?.user){ setUser(result.user) }\n        navigate('dashboard')\n    }  \n \n    return ( \n        <>  \n            <ContainerUnauthenticated> \n                <FormTitle>Bem-vindo de volta!</FormTitle>\n                <FormText>Entre com seus dados do cadastro para acessar sua conta</FormText> \n                <Input placeholder=\"E-mail\" value={formValue('identifier')} onChange={e => changeForm(e.target.value, 'identifier')} /> \n                <FormSpacer />\n                <Input placeholder=\"Senha\" type=\"password\" value={formValue('password')} onChange={e => changeForm(e.target.value, 'password')} />   \n                <RegisterForgot>\n                    Esqueceu a senha?\n                    <ForgotLink onClick={() => navigate('forgot')}>Recupere sua senha</ForgotLink>\n                </RegisterForgot> \n                <FormSpacer /> \n                <Button primary loading={loading} onClick={login}>Entrar</Button>\n                <RegisterCall> Ainda não tem conta? </RegisterCall>\n                <Button primary outline onClick={() => navigate('register')}>Criar uma conta</Button> \n            </ContainerUnauthenticated> \n        </>\n    );\n}"]},"metadata":{},"sourceType":"module"}